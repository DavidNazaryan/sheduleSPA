#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è @david_nazaryan –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
"""

import requests
import sys

def assign_admin():
    """–ù–∞–∑–Ω–∞—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è @david_nazaryan –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º"""
    
    # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è @david_nazaryan (–Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ Telegram)
    # –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã–π ID
    user_id = 123456789  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    
    # API endpoint
    API_URL = "http://localhost:8000/api/users/role"
    
    payload = {
        "user_id": user_id,
        "role": "admin",
        "group_id": None  # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥—Ä—É–ø–ø–µ
    }
    
    try:
        response = requests.post(API_URL, json=payload)
        response.raise_for_status()
        
        result = response.json()
        if result.get("success"):
            print(f"‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} —É—Å–ø–µ—à–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º!")
            print("–¢–µ–ø–µ—Ä—å @david_nazaryan –º–æ–∂–µ—Ç:")
            print("- –£–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º–∏ –≥—Ä—É–ø–ø–∞–º–∏")
            print("- –ù–∞–∑–Ω–∞—á–∞—Ç—å —Å—Ç–∞—Ä–æ—Å—Ç –¥–ª—è –ª—é–±—ã—Ö –≥—Ä—É–ø–ø")
            print("- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –≥—Ä—É–ø–ø—ã –≤ —Å–∏—Å—Ç–µ–º–µ")
        else:
            print(f"‚ùå –û—à–∏–±–∫–∞: {result.get('message', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞')}")
            
    except requests.exceptions.RequestException as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API: {e}")
        print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:8000")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")

def get_user_id_by_username():
    """–ü–æ–ª—É—á–∞–µ—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ username —á–µ—Ä–µ–∑ Telegram API"""
    print("–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è @david_nazaryan:")
    print("1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∫–æ–º–∞–Ω–¥—É /start")
    print("2. –û—Ç–∫—Ä–æ–π—Ç–µ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ")
    print("3. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: console.log(window.Telegram.WebApp.initData)")
    print("4. –ù–∞–π–¥–∏—Ç–µ user.id –≤ –¥–∞–Ω–Ω—ã—Ö")
    print("5. –ó–∞–º–µ–Ω–∏—Ç–µ user_id –≤ —ç—Ç–æ–º —Å–∫—Ä–∏–ø—Ç–µ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π ID")
    print()
    print("–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")

if __name__ == "__main__":
    print("üîß –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞")
    print("=" * 40)
    
    if len(sys.argv) > 1 and sys.argv[1] == "--help":
        get_user_id_by_username()
    else:
        print("‚ö†Ô∏è  –í–Ω–∏–º–∞–Ω–∏–µ: –ó–∞–º–µ–Ω–∏—Ç–µ user_id –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è @david_nazaryan")
        print("–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ID –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: python assign_admin.py --help")
        print()
        
        confirm = input("–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å —Ç–µ—Å—Ç–æ–≤—ã–º ID? (y/N): ")
        if confirm.lower() == 'y':
            assign_admin()
        else:
            print("–û—Ç–º–µ–Ω–µ–Ω–æ. –û–±–Ω–æ–≤–∏—Ç–µ user_id –≤ —Å–∫—Ä–∏–ø—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞.")

